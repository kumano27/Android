# Android  

最終編集日時:2018/10/30


### Androidとは  
Googleが開発、公開している携帯端末やタブレットPCのOS。  
Linuxをベースに開発され、アプリケーションを実行するために **Dalvik VM** 等のソフトウェアが搭載されている。  

___  

Dalvik VM?  
ダルビック仮想マシン  
Android 5.0より **Android Runtime** に置き換えられた。  

* 簡単に...  
Androidアプリを端末で実行する際は、アプリのコードを実行可能にする必要がある(コンパイル)。  
このプロセスを担うもの。  

___  


### Androidを構成する要素  
* Linuxカーネル
* アプリケーションフレームワーク
* アプリケーション
* ライブラリー


### Androidの中身
Androidの構成は下図の通り  

この構造を **Androidアーキテクチャー** と呼ぶ。  

これはハードウェアが最下部に位置し、  
ソフトウェアを用途別にグループ分けを行い、  
ハードウェアに近い処理を行うグループから順に積み重ねる図。  
画像では見切れているが、Linuxカーネルの更に下層がハードウェア。  

デバイスドライバ群(Linuxカーネル部分)とアプリケーションフレームワークの橋渡しを行っているのが  
ミドルウェア群(ライブラリやAndroidランタイム)。  

* 処理の流れ  
ユーザーがアプリを操作  
↓  
ミドルウェア群ソフトウェア順次呼び出し  
↓  
Linuxカーネルのデバイスドライバーに処理命令  
↓  
ハードウェアが応答  

![Android_architecture](./memo_img/android_architecture.png)

各グループを簡単に...  


#### アプリケーション  
* Androidアーキテクチャーの最上部に位置  
* ユーザーからの操作を直接受ける箇所(ホーム[待ち受け画面]、webブラウザー、等のAndroidアプリケーション)  
* Androidアプリケーションは基本的にJavaで記述  
* AndroidアプリケーションはJavaソースコード以外にXML形式ファイル(操作画面の設定情報やアプリで使用する文字の情報を収めたもの)、
リソースファイル(アイコンや画像などを表示するファイル)で成り立つ  
* 上記はAndroid開発ツールでビルド(実行可能なファイルに)する時に1つのパッケージとしてまとめられる  
* 開発したアプリを配布(公開)する時は開発ツールを使用し **apk** 形式のファイルにまとめられる  


#### アプリケーションフレームワーク  
* アプリケーション層の下に位置  
* AndroidのAPI群  
* API(Application Programming Interface)はOSの機能を利用する為の「窓口」として機能する  

	アプリケーションフレームワークのコンポーネント構成
	* アクティビティマネージャー(Activity Manager)  
	アプリの起動、中断、終了などのライフサイクルを提供、管理を行う  

	* ビューシステム(View System)  
	UI(ユーザーインターフェース)を構成する部品を提供、イベントの発生管理を行う  

	* ウィンドウマネージャー(Window Manager)  
	スクリーンの領域をウィンドウに分けて管理し、描画用のサーフェス(フレーム用のバッファ)を割り当てる  
	ウィンドウ関連の処理を行うコンポーネント  

	* コンテントプロバイダー(Content Provider)  
	アプリ間で共有可能なデータをカプセル化したコンポーネント  

	* ロケーションマネージャー(Location Manager)  
	Android端末が位置情報を認識できるようにするコンポーネント  

	* ノーティフィケーションマネージャー(Notification Manager)  
	ユーザーの操作に割り込むことなく、メッセージの着信などの重要なイベントを通知するためのコンポーネント  

	* パッケージマネージャー(Package Manager)  
	端末にインストールされている他のアプリのパッケージに関する情報を取得する為のコンポーネント  

	* リソースマネージャー(Resource Manager)  
	アプリから文字や画像などのリソースにアクセスできるようにするコンポーネント  

	* テレフォニーマネージャー(Telephony Manager)  
	端末のテレフォニー(電話)サービスに関する着信や発信などの情報をアプリ側で取得できるようにするコンポーネント  


#### ライブラリ  
* APIとLinuxカーネルのドライバー群との橋渡しを行うソフトウェアが含まれる。  
CやC++で記述されていて、機械語(ネイティブコード)にコンパイルされた状態で各グループごとにライブラリとして納められえる。  

	ハードウェアに近い低いレベルの処理例(低水準言語?)  
	* Free Type  
	ビットマップ形式とベクター形式によるフォントのレンダリング(描画)をサポート  

	* libc  
	C言語の標準システムライブラリ  
	Linuxベースの携帯端末用にチューニングされている。  

	* LibWebCore  
	AndroidブラウザーとUI部品のWebViewを駆動するための高速なWebブラウザーを提供する為のライブラリ  
	「WebKit」と呼ばれるライブラリをベースとし、GoogleChromeやAppleのSafariにも使われている。  

	* Media Framework  
	PacketVideo社のOpenCOREをベースとする音声・動画の録音(録画)、再生、静止画の撮影を行うためのライブラリ  
		* サポートフォーマット  
			* MPEG-4  
			* H.264  
			* MP3  
			* AAC  
			* AMR  
			* JPEG  
			* PNG  
			* GIF  
			etc...

	* OpenGL ES(Embedded System)  
	OpenGL ES 1.0/1.1/2.0のAPI群をベースとするOpenGLを実装するための3Dグラフィックス用ライブラリ  
	ハードウェア側に3Dアクセラレーション(描画を支援する機能)が利用出来ない時のために、独自の3Dソフトウェアスタライザーが用意されている。  
		* OpenGL  
		Open Graphics Library、2D・3DCGライブラリ
	* SGL  
	標準的(?)な2Dグラフィックスエンジンを提供するライブラリ  

	* SQLite  
	すべてのアプリから利用可能な、軽量かつ高性能なリレーショナルデータベースエンジンを提供するライブラリ  
	iPhoneでも使用されている  

	* SSL  
	SSL(Secure Sockets Layer)をベースとしたセキュアな通信を提供するためのライブラリ  

	* Surface Manager  
	ディスプレイへのアクセスを管理するライブラリ  

	* Androidランタイム  
	Java 1.5 SEと互換性を持つライブラリ  
	アプリケーション開発者は、Java言語での開発と同じ感覚でコア・ライブラリを扱える  
	「Dalvik(ダルビック)仮想マシン」、「コア・ライブラリ」で構成される  
		* Dalvik仮想マシン  
		* コア・ライブラリ  


#### Linuxカーネル  
* スクリーンへの表示やタッチスクリーンからの入力、フラッシュメモリ、カメラ、オーディオ、Wi-Fi機器等  
ハードウェアと直接やり取りを行う部分(デバイスドライバー)  
* ハードウェア用のドライバーに加え、プロセス間通信や電源管理用のドライバが含まれる。  
* OSの基盤  
* デスクトップ用OSのLinuxをベースとし、モバイル用に新たに開発されたOS  

